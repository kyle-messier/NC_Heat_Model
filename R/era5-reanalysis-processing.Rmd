---
title: "era5-reanalysis-processing"
output: github_document
 #pdf_document: default
#  html_document: default
date: "2023-07-24"
---

#### Libraries

```{r, message=F}
# -- for spatial data
#library(raster)   # -- old
#library(rgdal)    # -- deprecated in 10/2023
#library(rgeos)    # -- deprecated in 10/2023
#library(maptools) # -- deprecated in 10/2023
options("sp_evolution_status" = 2) # use sf instead of rgdal and rgeos in sp
library(sp)
library(terra)
library(sf)
library(ncdf4)

# -- for timeseries
library(lubridate)
library(zoo)
library(xts)

# -- 
library(ggplot2)
library(ggspatial)
library(tidyterra)
library(maditr)
library(tidyverse)
library(viridis)
library(DT)
```

#### NC shapefile

```{r, warning=FALSE}
nc.borders <- vect("../input/NC_county_boundary/North_Carolina_State_and_County_Boundary_Polygons.shp")
```

#### Map function creation

Create a function to map rasters with NC borders

```{r}

my.map.raster <- function(raster, date, title){
	plot <- ggplot() +
  geom_spatraster(data = raster) +
  geom_sf(data = st_as_sf(nc.borders), aes(geometry=geometry), 
               colour = "white", linewidth=.3, fill = NA) +
  scale_fill_whitebox_c(
    palette = "muted",
    labels = scales::label_number(suffix = "ยบ"),
    n.breaks = 12,
    guide = guide_legend(reverse = TRUE)
  ) +
  labs(
    fill = "",
    title = title,
    subtitle = date
  ) +
  annotation_scale(
    location="bl", pad_x = unit(1, "cm"), 
		pad_y = unit(1, "cm"), 
		height = unit(0.30, "cm"), 
		text_cex = 1
	) +
	annotation_north_arrow(
	  location = "br", 
	  which_north = "true", 
		pad_x = unit(0.2, "cm"), 
		pad_y = unit(0.2, "cm")
	) +
	theme(
			axis.text = element_text(size=12, family="serif"),
			plot.caption = element_text(size=10, family="serif"),
			legend.text = element_text(size=12, family="serif"),
			legend.title = element_text(size=12, family="serif"),
			panel.background = element_rect(fill = "white"),
			panel.grid.major=element_line(colour="grey")
		)
	
  return(plot)
}


my.map.raster.points <- function(raster, points, points.fill, date, title){
  fill <- enquo(points.fill)
	plot <- ggplot() +
  geom_spatraster(data = raster) +
	geom_sf(data = points, 
             aes(geometry=geometry, fill=!!fill), color='black',
             size=2, shape=21)+
	geom_sf(data = st_as_sf(nc.borders), aes(geometry=geometry), 
               colour = "white", linewidth=.3, fill = NA) +
  scale_fill_whitebox_c(
    palette = "muted",
    labels = scales::label_number(suffix = "ยบ"),
    n.breaks = 12,
    guide = guide_legend(reverse = TRUE)
  ) +
  labs(
    fill = "",
    title = title,
    subtitle = date
  ) +
  annotation_scale(
    location="bl", pad_x = unit(1, "cm"), 
		pad_y = unit(1, "cm"), 
		height = unit(0.30, "cm"), 
		text_cex = 1
	) +
	annotation_north_arrow(
	  location = "br", 
	  which_north = "true", 
		pad_x = unit(0.2, "cm"), 
		pad_y = unit(0.2, "cm")
	) +
	theme(
			axis.text = element_text(size=12, family="serif"),
			plot.caption = element_text(size=10, family="serif"),
			legend.text = element_text(size=12, family="serif"),
			legend.title = element_text(size=12, family="serif"),
			panel.background = element_rect(fill = "white"),
			panel.grid.major=element_line(colour="grey")
		)
	
  return(plot)
}

```

## Daily summary computation

#### Open and map hourly temperature ERA5 reanalysis

Open netcdf data with all JJA hourly ERA5 reanalysis

```{r}
t2m.rea <- nc_open("../input/era5_hourly_reanalysis_20220531_20220930.nc")
print(t2m.rea)
```

Extract data in vectors and 3d-matrix

```{r}
lon <- ncvar_get(t2m.rea, "longitude")
lat <- ncvar_get(t2m.rea, "latitude")
time <- ncvar_get(t2m.rea, "time")
t2m <- ncvar_get(t2m.rea, "t2m") - 273.15
na.value <- ncatt_get(t2m.rea, "t2m", "_FillValue")$value
t2m[t2m==na.value] <- NA
cat(paste('time units:', ncatt_get(t2m.rea, "time", "units")$value))
time <- as.POSIXct(time*3600, origin="1900-01-01", tz="UTC")
```

Map T2M for one hour

```{r}
# one time
ts <- as.POSIXct("2022-08-02 18:00:00 UTC", tz='UTC')
samp <- t2m[,,which(time==ts)]
# need to add 0.25/2 to 
samp.rast <- rast(t(samp), extent=c(-85.125,-74.875,33.375,37.125), crs='+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0')

my.map.raster(raster=samp.rast, date=paste(ts, 'UTC'), title="T2m North Carolina")
```

Create a datatable from the netcdf

```{r}
t2m.ts <- t2m %>% melt() %>% setDT
t2m.ts <- t2m.ts[,.(time=time[Var3], lon=Var1, lat=Var2, t2m=value)]
head(t2m.ts)
```

Add pixel id (geom variable)

```{r}
pixels <- unique(t2m.ts[,c('lon', 'lat')])
pixels$geom <- index(pixels)
t2m.ts <- merge(t2m.ts, pixels, by=c('lon', 'lat'))
head(t2m.ts)
```

#### Computation of daily summary

TN

```{r}
ts <- as.POSIXct("2022-05-31 01:00:00 UTC", tz='UTC')
te <- as.POSIXct("2022-09-01 23:00:00 UTC", tz='UTC')
t2m.ts <- t2m.ts[between(time, ts, te)]

# -- EDT = Eastern Daylight Time (consider clock-changing)
# -- EST = Eastern Standard Time
t2m.ts <- t2m.ts[, ':='(time.EDT=as.POSIXct(with_tz(time, tzone="America/New_York"), format = "%Y-%m-%d %H:%M:%s"))]

# -- compute standard date for TN with WMO definition
dateTNwmo <- function(x){
  return(ifelse(hour(x)>=18, substr(x+days(1),0,10), substr(x,0,10)))
}
# -- compute standard date for TN with 7am to 7am (localtime) definition 
date7am <- function(x.EDT){
  return(ifelse(hour(x.EDT)>=7, substr(x.EDT,0,10), substr(x.EDT-days(1),0,10)))
}
# -- compute standard date for TN with 12am to 12am definition
date12am <- function(x.EDT){
  return(substr(x.EDT,0,10))
}

t2m.ts <- t2m.ts[, ':='(dateTNwmo=as.character(dateTNwmo(time)),
                        date7am=as.character(date7am(time.EDT)),
                        date12am=as.character(date12am(time.EDT)))]

t2m.TNwmo <- t2m.ts[, .(TNwmo=min(t2m)), keyby=c('geom', 'dateTNwmo', 'lon', 'lat')]
t2m.TN7am <- t2m.ts[, .(TN7am=min(t2m)), keyby=c('geom', 'date7am', 'lon', 'lat')]
t2m.TN12am <- t2m.ts[, .(TN12am=min(t2m)), keyby=c('geom', 'date12am', 'lon', 'lat')]

# -- merge the 3 data.tables 
t2m.TN <- merge(t2m.TNwmo, t2m.TN7am, 
                by.x=c('geom', 'dateTNwmo', 'lon', 'lat'), 
                by.y=c('geom', 'date7am', 'lon', 'lat'))
t2m.TN <- merge(t2m.TN, t2m.TN12am, 
                by.x=c('geom', 'dateTNwmo', 'lon', 'lat'), 
                by.y=c('geom', 'date12am', 'lon', 'lat'))
colnames(t2m.TN)[colnames(t2m.TN) == "dateTNwmo"] <- "date"
t2m.TN$lon <- as.numeric(t2m.TN$lon)
t2m.TN$lat <- as.numeric(t2m.TN$lat)
t2m.TN$date <- ymd(t2m.TN$date)

# -- remove 2022-05-31 and 2022-09-01 which are not computed properly
t2m.TN <-  t2m.TN[!(date==ymd('2022-05-31') | date==ymd('2022-09-01'))]

summary(t2m.TN)
beepr::beep(1)
```

TX

```{r}
# -- compute standard date for TX with WMO definition
dateTXwmo <- function(x){
  return(ifelse(hour(x)<6, substr(x-days(1),0,10), substr(x,0,10)))
}

t2m.ts <- t2m.ts[, ':='(dateTXwmo=as.character(dateTXwmo(time)),
                        date7am=as.character(date7am(time.EDT)),
                        date12am=as.character(date12am(time.EDT)))]

t2m.TXwmo <- t2m.ts[, .(TXwmo=max(t2m)), keyby=c('geom', 'dateTXwmo', 'lon', 'lat')]
t2m.TX7am <- t2m.ts[, .(TX7am=max(t2m)), keyby=c('geom', 'date7am', 'lon', 'lat')]
t2m.TX12am <- t2m.ts[, .(TX12am=max(t2m)), keyby=c('geom', 'date12am', 'lon', 'lat')]

# -- merge the 3 data.tables 
t2m.TX <- merge(t2m.TXwmo, t2m.TX7am, 
                by.x=c('geom', 'dateTXwmo', 'lon', 'lat'), 
                by.y=c('geom', 'date7am', 'lon', 'lat'))
t2m.TX <- merge(t2m.TX, t2m.TX12am, 
                by.x=c('geom', 'dateTXwmo', 'lon', 'lat'), 
                by.y=c('geom', 'date12am', 'lon', 'lat'))
colnames(t2m.TX)[colnames(t2m.TX) == "dateTXwmo"] <- "date"
t2m.TX$lon <- as.numeric(t2m.TX$lon)
t2m.TX$lat <- as.numeric(t2m.TX$lat)
t2m.TX$date <- ymd(t2m.TX$date)

# -- remove 2022-05-31 and 2022-09-01 which are not computed properly
t2m.TX <-  t2m.TX[!(date==ymd('2022-05-31') | date==ymd('2022-09-01'))]

summary(t2m.TX)
beepr::beep(1)
```

Check algorithm result on a given pixel

```{r}
ts <- as.POSIXct("2022-08-01 00:00:00 UTC", tz='UTC')
te <- as.POSIXct("2022-08-31 00:00:00 UTC", tz='UTC')
g <- 500
df.plot.h <- t2m.ts[between(time, ts, te) & geom==g]
df.plot.TX <- t2m.TX[between(as.POSIXct(date), ts, te) & geom==g]
df.plot.TN <- t2m.TN[between(as.POSIXct(date), ts, te) & geom==g]

ggplot(df.plot.h)+
  geom_line(aes(x=time, y=t2m))+
  geom_point(data=df.plot.TX, aes(x=as.POSIXct(date), y=TXwmo), color='red', shape=1)+
  geom_point(data=df.plot.TX, aes(x=as.POSIXct(date), y=TX7am), color='blue', shape=4)+
  geom_point(data=df.plot.TX, aes(x=as.POSIXct(date), y=TX12am), color='green',shape=3)+
  geom_point(data=df.plot.TN, aes(x=as.POSIXct(date), y=TNwmo), color='orange', shape=1)+
  geom_point(data=df.plot.TN, aes(x=as.POSIXct(date), y=TN7am), color='purple', shape=4)+
  geom_point(data=df.plot.TN, aes(x=as.POSIXct(date), y=TN12am), color='yellow',shape=3)

```

Merge TN and TM in the same data.table and save it

```{r}
era5.t2m <- merge(t2m.TN, t2m.TX, by=c("geom", "date", "lon", "lat"))
fwrite(era5.t2m, '../input/era5_daily_reanalysis_20220601_20220831.csv')
```

## Check coherence with NOAA observations

IMPORTANT: the following code is just a first sight because the standard day chosen for the computation of TN and TX varies from one NOAA source to another:

-   COOP: 7am to 7am local time

-   CRN: ?

-   RAWS: ?

-   ASOS/WBAN: 12am to 12am local time

#### Open NOAA obs

```{r}
aws <- data.table::fread("../input/NC-AWS-NOAA-dailysummary-20220601-20220831.csv") 
length(unique(aws$STATION))
aws <- aws[which(!(is.na(aws$TMAX)|is.na(aws$TMIN))),] 
aws$DATE <- as.Date(aws$DATE, format = "%Y-%m-%d")
length(unique(aws$STATION))
```

Daily max temperatures

```{r, message=FALSE}
aws.ts.tx <- maditr::dcast(aws[, c('DATE', 'STATION', 'TMAX')], DATE ~ STATION) %>%
  as.xts() 
```

Daily min temperatures

```{r, message=FALSE}
aws.ts.tn <- maditr::dcast(aws[, c('DATE', 'STATION', 'TMIN')], DATE ~ STATION) %>%
  as.xts() 
```

Daily mean temperatures

```{r, message=FALSE}
aws.ts.tm <- maditr::dcast(aws[, c('DATE', 'STATION', 'TAVG')], DATE ~ STATION) %>%
  as.xts() 
```

Timeseries plots

***Important:** mean temperatures are missing for most of the weather stations.*

```{r}
plot((aws.ts.tn-32)*5/9)
plot((aws.ts.tx-32)*5/9)
plot((aws.ts.tm-32)*5/9)

boxplot(t((aws.ts.tn-32)*5/9))
boxplot(t((aws.ts.tx-32)*5/9))
boxplot(t((aws.ts.tm-32)*5/9))
```

NOAA aws with less than 5% missing data

```{r , message=FALSE}
nb.na.tn <- lapply(aws.ts.tn, FUN=function(x) sum(is.na(x)))  
nb.na.tn <- as.data.frame(do.call(rbind, nb.na.tn))
nb.na.tn <- cbind(STATION = rownames(nb.na.tn), nb.na.tn)
rownames(nb.na.tn) <- 1:nrow(nb.na.tn)
names(nb.na.tn)[names(nb.na.tn) == 'V1'] <- 'nb.na.tn'

nb.na.tx <- lapply(aws.ts.tx, FUN=function(x) sum(is.na(x)))  
nb.na.tx <- as.data.frame(do.call(rbind, nb.na.tx))
nb.na.tx <- cbind(STATION = rownames(nb.na.tx), nb.na.tx)
rownames(nb.na.tx) <- 1:nrow(nb.na.tx)
names(nb.na.tx)[names(nb.na.tx) == 'V1'] <- 'nb.na.tx'

nb.na.tm <- lapply(aws.ts.tm, FUN=function(x) sum(is.na(x)))  
nb.na.tm <- as.data.frame(do.call(rbind, nb.na.tm))
nb.na.tm <- cbind(STATION = rownames(nb.na.tm), nb.na.tm)
rownames(nb.na.tm) <- 1:nrow(nb.na.tm)
names(nb.na.tm)[names(nb.na.tm) == 'V1'] <- 'nb.na.tm'

stations <- unique(aws[,c('STATION', 'NAME', 'LATITUDE', 'LONGITUDE', 'ELEVATION')])
stations <- list(stations, nb.na.tx, nb.na.tn, nb.na.tm) %>% reduce(full_join, by='STATION')
aws <- list(aws, nb.na.tx, nb.na.tn, nb.na.tm) %>% reduce(full_join, by='STATION')

# -- turn into a sf object to reproject CRS
stations <- st_as_sf(stations, coords=c('LONGITUDE', 'LATITUDE'))
st_crs(stations) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
stations <- st_transform(stations, crs(nc.borders))
stations <- data.frame(stations)

datatable(stations, filter = 'top')

# -- remove stations with >5 missing data
aws <- aws[which(aws$nb.na.tn<=5 | aws$nb.na.tx<=5),]
```

Change aws dataframe projection

```{r, message=F}
# -- turn into a sf object to reproject CRS
aws <- st_as_sf(aws, coords=c('LONGITUDE', 'LATITUDE'))
st_crs(aws) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
aws <- st_transform(aws, crs(nc.borders))
aws <- data.frame(aws)
```

Function to extract a date in era5 TX and TN data.table

```{r}
era5.date <- function(day, era5, field){
  era5.date <- era5[date==day]
  era5.date <- vect(era5.date, geom=c('lon', 'lat'), crs="+proj=longlat +datum=WGS84")
  empty.rast <- rast(nrows=16, ncol=41, extent=c(-85.12,-75.12,33.30,37.05), 
                     crs='+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0')
  era5.date <- rasterize(x=era5.date, y=empty.rast, field=field)
  era5.date <- project(era5.date, crs(nc.borders))
  return(era5.date)
}
```

#### Map several date examples

```{r}
date <- as.Date('2022-06-06')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

date <- as.Date('2022-06-14')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'),
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina (very high TN)")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'),  
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

date <- as.Date('2022-06-20')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'),
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'),  
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

date <- as.Date('2022-07-26')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'),
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina (very high TN) ")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'),  
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

date <- as.Date('2022-07-30')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'),
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina (very high TN)")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

date <- as.Date('2022-08-01')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

date <- as.Date('2022-08-15')
my.map.raster.points(era5.date(date, era5.t2m, field='TNwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMIN-32)*5/9, 
                     date=date, title="TN North Carolina (low TN)")
my.map.raster.points(era5.date(date, era5.t2m, field='TXwmo'), 
                     points=aws[which(aws$DATE==date),], 
                     points.fill = (TMAX-32)*5/9, 
                     date=date, title="TX North Carolina")

```

## Save as raster .tif

```{r}
empty.rast <- rast(nrows=16, ncol=41, extent=c(-85.12,-75.12,33.30,37.05), 
                     crs='+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0')
date.vector <- as.character(unique(sort(era5.t2m$date)))
era5.jja.vector.TNwmo <- c()
era5.jja.vector.TN7am <- c()
era5.jja.vector.TN12am <- c()
era5.jja.vector.TXwmo <- c()
era5.jja.vector.TX7am <- c()
era5.jja.vector.TX12am <- c()

for(d in date.vector){
  era5.d <- era5.t2m[date==d]
  era5.d.vect <- vect(era5.d, geom=c('lon', 'lat'), crs="+proj=longlat +datum=WGS84")
  
  era5.d.rast.TNwmo <- rasterize(x=era5.d.vect, y=empty.rast, field=c('TNwmo'))
  era5.jja.vector.TNwmo <- c(era5.jja.vector.TNwmo, era5.d.rast.TNwmo)
  
  era5.d.rast.TN7am <- rasterize(x=era5.d.vect, y=empty.rast, field=c('TN7am'))
  era5.jja.vector.TN7am <- c(era5.jja.vector.TN7am, era5.d.rast.TN7am)
  
  era5.d.rast.TN12am <- rasterize(x=era5.d.vect, y=empty.rast, field=c('TN12am'))
  era5.jja.vector.TN12am <- c(era5.jja.vector.TN12am, era5.d.rast.TN12am)
  
  era5.d.rast.TXwmo <- rasterize(x=era5.d.vect, y=empty.rast, field=c('TXwmo'))
  era5.jja.vector.TXwmo <- c(era5.jja.vector.TXwmo, era5.d.rast.TXwmo)
  
  era5.d.rast.TX7am <- rasterize(x=era5.d.vect, y=empty.rast, field=c('TX7am'))
  era5.jja.vector.TX7am <- c(era5.jja.vector.TX7am, era5.d.rast.TX7am)
  
  era5.d.rast.TX12am <- rasterize(x=era5.d.vect, y=empty.rast, field=c('TX12am'))
  era5.jja.vector.TX12am <- c(era5.jja.vector.TX12am, era5.d.rast.TX12am)
}

era5.jja.vector.TNwmo <- rast(era5.jja.vector.TNwmo)
names(era5.jja.vector.TNwmo) <- date.vector

era5.jja.vector.TN7am <- rast(era5.jja.vector.TN7am)
names(era5.jja.vector.TN7am) <- date.vector

era5.jja.vector.TN12am <- rast(era5.jja.vector.TN12am)
names(era5.jja.vector.TN12am) <- date.vector

era5.jja.vector.TXwmo <- rast(era5.jja.vector.TXwmo)
names(era5.jja.vector.TXwmo) <- date.vector

era5.jja.vector.TX7am <- rast(era5.jja.vector.TX7am)
names(era5.jja.vector.TX7am) <- date.vector

era5.jja.vector.TX12am <- rast(era5.jja.vector.TX12am)
names(era5.jja.vector.TX12am) <- date.vector

plot(era5.jja.vector.TNwmo[[1:4]])
plot(era5.jja.vector.TN12am[[1:4]])
plot(era5.jja.vector.TN7am[[1:4]])
plot(era5.jja.vector.TXwmo[[1:4]])
plot(era5.jja.vector.TX12am[[1:4]])
plot(era5.jja.vector.TX7am[[1:4]])

writeRaster(era5.jja.vector.TNwmo, 
            '../input/era5_daily_reanalysis_20220601_20220831_TNwmo.tif', overwrite=T)
writeRaster(era5.jja.vector.TXwmo, 
            '../input/era5_daily_reanalysis_20220601_20220831_TXwmo.tif', overwrite=T)

writeRaster(era5.jja.vector.TN7am, 
            '../input/era5_daily_reanalysis_20220601_20220831_TN7am.tif', overwrite=T)
writeRaster(era5.jja.vector.TX7am, 
            '../input/era5_daily_reanalysis_20220601_20220831_TX7am.tif', overwrite=T)

writeRaster(era5.jja.vector.TN12am, 
            '../input/era5_daily_reanalysis_20220601_20220831_TN12am.tif', overwrite=T)
writeRaster(era5.jja.vector.TX12am, 
            '../input/era5_daily_reanalysis_20220601_20220831_TX12am.tif', overwrite=T)
```

Session info

```{r}
sessionInfo()
```
